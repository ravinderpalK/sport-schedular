<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/tailwind.css">
  <title>Document</title>
  <script>
    function joinSession(id) {
      fetch(`/sessions/${id}`, {
        method: "put",
        headers: { "Content-Type": "application/json" },
      })
        .then((res) => {
          if (res.ok) {
            window.location.reload();
          }
        })
        .catch((err) => console.log(err));
    }
  </script>
</head>

<body>
  <div class="grid grid-cols-6">
    <div class="col-start-3 col-span-2">
      <div>
        <%- include('header.ejs') %>
      </div>
      <h1 class="py-2 text-4xl text-gray-700">
        <%=sport.name%> session <span class="text-3xl">#<%= session.id%></span>
      </h1>
      <p class="py-2 text-base">This session is scheduled for <%=session.date%>, to be played at "<%=session.address%>"
      </p>
      <div>
        <p class="py-2 text-2xl">Players</p>
        <div class="grid grid-cols-3 ">
          <% if (session.players_name.length==0 ) {%>
            <p>No one have joined.</p>
            <% } else { %>
              <% (session.players_name).forEach(name=> { %>
                <div class="border border-gray-400 rounded p-2 my-1 mr-2">
                  <%= name %>
                </div>
                <% }) %>
                  <% } %>
        </div>
        <div>
          <% var r=(session.players_name).find((name)=> name==user.firstName) %>
            <% if (!r) { %>
              <button onclick="joinSession(<%=session.id%>)" class="block underline py-2 text-blue-800">Join the
                session</button>
              <% } %>
        </div>
      </div>
    </div>
  </div>
</body>

</html>